/*!
 * Varvet-Pageable
 * Self-contained wheel listening plugin to switch pages within a
 * static window.
 * Written by Johan Halse, https://twitter.com/hejsna, johan@varvet.se
 * License: http://johanhalse.mit-license.org
 * @version 0.1
 * @return {object}         Self
 */
var Pageable=function(a){var b=this,c=function(){};b.settings={pages:0,pageHeight:1e3,direction:"deltaY",stopAtPage:!1,momentum:!1,easeBack:!1,eventTimeout:100,onScrollStart:c,onScroll:c,onScrollStop:c,onPageChange:c},b.extend(b.settings,a),b.page=0,b.delta=0,b.scrolling=!1,b.stoppedAtPage=null,b.onScrollStop=b.debounce(b.onScrollStop,b.settings.eventTimeout,b),addWheelListener(window,b.proxy(b.onScroll,b))};Pageable.prototype={proxy:function(a,b){return function(){var c=Array.prototype.slice.call(arguments);return a.apply(b,c)}},extend:function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},gotoPage:function(a){var b=this.page;this.page=a,this.settings.onPageChange.apply(this,[b,this.page]),this.percentage=0,this.delta=0,this.stoppedAtPage=!0},enable:function(){this.disabled=!1},disable:function(){this.disabled=!0},onScrollStart:function(){this.scrolling=!0,this.delta=0,this.settings.onScrollStart.apply(this,[this.percentage,this.page])},debounce:function(a,b,c){var d;return function(){var e=function(){d=null,a.apply(c,[])};clearTimeout(d),d=setTimeout(e,b)}},onScroll:function(a){return a.preventDefault(),this.disabled?!1:(this.onScrollStop(),this.settings.stopAtPage&&this.stoppedAtPage?!1:(0==this.scrolling&&this.onScrollStart(a),this.delta+=a[this.settings.direction],this.percentage=this.delta/this.settings.pageHeight,this.settings.momentum&&(this.page==this.settings.pages-1&&this.percentage>0||0==this.page&&this.percentage<0)&&(this.percentage=1/(1+Math.pow(Math.E,-this.percentage))-.5),this.percentage>=1&&this.page<this.settings.pages-1&&this.gotoPage(page+1),this.percentage<=-1&&this.page>0&&this.gotoPage(page-1),void this.settings.onScroll.apply(this,[this.percentage,this.page])))},onScrollStop:function(){this.stoppedAtPage&&(this.stoppedAtPage=null),this.settings.easeBack?this.startEasing():(this.settings.onScrollStop.apply(this,[this.percentage,this.page]),this.delta=0,this.scrolling=!1)},startEasing:function(){clearInterval(this.easeInterval),this.delta=0,this.easeStart=(new Date).getTime(),this.easeOrigin=this.percentage,this.easeInterval=setInterval(this.proxy(this.interpolateBack,this),16)},interpolateBack:function(){var a=(new Date).getTime()-this.easeStart;a>300&&(a=300,clearInterval(this.easeInterval)),this.percentage=this.easeOut(a,this.easeOrigin,-this.easeOrigin,300),this.settings.onScroll.apply(this,[this.percentage,this.page])},easeOut:function(a,b,c,d){return c*((a=a/d-1)*a*a*a*a+1)+b}},function(a,b){function c(b,c,g,h){b[d](f+c,"wheel"==e?g:function(b){!b&&(b=a.event);var c={originalEvent:b,target:b.target||b.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==b.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){b.preventDefault?b.preventDefault():b.returnValue=!1}};return"mousewheel"==e?(c.deltaY=-.7*b.wheelDelta,b.wheelDeltaX&&(c.deltaX=-1/30*b.wheelDeltaX)):c.deltaY=b.detail,g(c)},h||!1)}var d,e,f="";a.addEventListener?d="addEventListener":(d="attachEvent",f="on"),e="onwheel"in b.createElement("div")?"wheel":void 0!==b.onmousewheel?"mousewheel":"DOMMouseScroll",a.addWheelListener=function(a,b,d){c(a,e,b,d),"DOMMouseScroll"==e&&c(a,"MozMousePixelScroll",b,d)}}(window,document);